import java.io.*;
import java.security.*;

public class GDS {
    public static void main(String args[]) {
        try {
            String inputfile = "C:\\Users\\admin\\Documents\\CNS1265\\sujana.txt";

            // Generate DSA key pair
            KeyPairGenerator keygen = KeyPairGenerator.getInstance("DSA", "SUN");
            SecureRandom random = SecureRandom.getInstance("SHA1PRNG", "SUN");
            keygen.initialize(1024, random);

            KeyPair pair = keygen.generateKeyPair();
            PrivateKey priv = pair.getPrivate();
            PublicKey pub = pair.getPublic();

            // Initialize the Signature object
            Signature dsa = Signature.getInstance("SHA1withDSA", "SUN");
            dsa.initSign(priv);

            // Read the input file and update the signature
            try (FileInputStream fis = new FileInputStream(inputfile);
                 BufferedInputStream bufin = new BufferedInputStream(fis)) {

                byte[] buffer = new byte[1024];
                int len;
                while ((len = bufin.read(buffer)) != -1) {
                    dsa.update(buffer, 0, len);
                }
            }

            // Generate the digital signature
            byte[] realsig = dsa.sign();

            // Save the signature
            try (FileOutputStream sigfos = new FileOutputStream(
                    "C:\\Users\\admin\\Documents\\CNS1265\\signature.txt")) {
                sigfos.write(realsig);
            }

            // Save the public key
            byte[] key = pub.getEncoded();
            try (FileOutputStream keyfos = new FileOutputStream(
                    "C:\\Users\\admin\\Documents\\CNS1265\\publickey.txt")) {
                keyfos.write(key);
            }

            // Output
            System.out.println("Digital Signature generated successfully");
            System.out.println("Signature saved at: C:\\Users\\admin\\Documents\\CNS1265\\signature.txt");
            System.out.println("Public Key saved at: C:\\Users\\admin\\Documents\\CNS1265\\publickey.txt");

        } catch (Exception e) {
            System.out.print("Caught exception: " + e);
            e.printStackTrace();
        }
    }
}
